<!DOCTYPE html>
<html>
  <head>
    <title>chatbot</title>
  </head>
  <body>
    <div class="js-container"></div>
    <script src="react-basics.js"></script>
    <script src="https://unpkg.com/supersimpledev/react.js"></script>
    <script src="https://unpkg.com/supersimpledev/react-dom.js"></script>
    <script src="https://unpkg.com/supersimpledev/chatbot.js"></script>

    <script src="https://unpkg.com/supersimpledev/babel.js"></script>
    <script type="text/babel">
        function ChatInput({ Messages, setChatMessages }) {
            const [inputText, setInputText] = React.useState('');

            function saveInputText(event) {
                setInputText(event.target.value);
            }

            function sendMessage() {
                const newChatMessages=[
                    ...Messages,
                    { 
                        message: inputText, 
                        sender: 'user', 
                        id: crypto.randomUUID() 
                    }
                ]
                setChatMessages(newChatMessages);

                const response=Chatbot.getResponse(inputText);
                setChatMessages([
                    ...newChatMessages,
                    { 
                        message: response, 
                        sender: 'user', 
                        id: crypto.randomUUID() 
                    }
                ]);
                
                setInputText('');
        }
            return(
                <>
                    <input 
                        placeholder="send message to chatbot" 
                        size="30"
                        value={inputText}
                        onChange={saveInputText}
                    />
                    <button
                        onClick={sendMessage}
                    >Send</button>
                </>
            );
        }
        function ChatPrompt({message,sender}){
            // const{message,sender}=props
            // // const message=props.message;
            // const sender=props.sender;
            /*
            if(sender=="bot"){
                return(
                <div>
                    <img src="chatrobot.png" width="50" />
                    {message}
                </div>
            );
            }*/
           // (if  true then whatever (if true && result))
            return(
                <div>
                    {sender==='bot'&&<img src="chatrobot.png" width="50" />}
                    {message}
                    {sender==='user'&&<img src="user.png" width="50" />}
                </div>
            );
        }
        function ChatMessages({ Messages }){
            return(
                <>
                {Messages.map((Chat)=>(
                        <ChatPrompt 
                            message={Chat.message} 
                            sender={Chat.sender}
                            key={Chat.id}
                        />           
            ))}
            </>
        );
        }

        function App(){
            const [Messages, setChatMessages] = React.useState([
                { message:"hello chatbot", sender:"user", id:"id1" },
                { message:"hello! how can i help you", sender:"bot", id:"id2" },
                { message:"can you get me todays date", sender:"user", id:"id3" },
                { message:"today is sept 30", sender:"bot", id:"id4" }
            ]);


            return(
                <>
                <ChatInput Messages={Messages} setChatMessages={setChatMessages} />
                <ChatMessages Messages={Messages} />
                </>
            );

        }
        
      const container = document.querySelector('.js-container');
      ReactDOM.createRoot(container).render(<App />);
      
    </script>
  </body>
</html>